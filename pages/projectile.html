---
title: "Projectile, perspective, nameframe"
---

<div id="TOC">
<ul>
<li><a href="#кэширование">Кэширование</a></li>
<li><a href="#игнорировать-файлы-и-подкаталоги">Игнорировать файлы и подкаталоги</a></li>
<li><a href="#кнопочки">Кнопочки</a></li>
<li><a href="#настройки-проекта">Настройки проекта</a></li>
<li><a href="#mode-line">Mode line</a></li>
<li><a href="#perspective">perspective</a></li>
<li><a href="#проблемы">Проблемы</a></li>
<li><a href="#ссылки">Ссылки</a></li>
</ul>
</div>

<ul>
<li><p><a href="https://github.com/bbatsov/projectile" class="uri">https://github.com/bbatsov/projectile</a> — основное, о чём я тут.</p></li>
<li><p><a href="https://github.com/nex3/perspective-el" class="uri">https://github.com/nex3/perspective-el</a> — создаёт именованные перспективы, и как-то сужает тучку зрения. Так, автодополнение имени буфера начинает работать только внутри перспективы. Деактивировала. Если будет ситуация, что мне захочется «перестать видеть» все другие буферы, включу. Если так и не буду пользоваться - сочту, что мне не надо, и удалю.</p></li>
<li><p><a href="https://github.com/john2x/nameframe" class="uri">https://github.com/john2x/nameframe</a> — в сочетании с двумя предыдущими при переключении в другой проект, переключает в его фрейм с выделенной «перспективой». Сочла нужным удалить, так как мне оказалось неудобно.</p></li>
</ul>
<p>Projectile — библиотека для работы с проектами. Проект — это каталог, в котором содержится специальный файл: либо .projectile, либо файлы/каталоги, по которым можно узнать репозиторий какой-то vcs, либо ещё какие-то незнакомые мне варианты. У меня обычно проект под git. Впрочем, .projectile тоже делала.</p>
<p>Я упоминаю тут сильно не всё, только то, что сама хотела бы либо помнить, либо держать под рукой.</p>
<h2 id="кэширование">Кэширование</h2>
<p>Так как индексирование больших проектов не совсем быстро, Projectile умеет кэшировать файлы проекта. Чтобы разрешить кэширование, используйте:</p>
<pre><code>(setq projectile-enable-caching t)</code></pre>
<p>Кэш сохраняется в папке emacs. У меня есть, мне удобно. Даже при том, что проекты у меня невелики. Во всяком случае, кэширование редко мешает, а если что, запуск <code>C-u C-c p f</code> очистит кэш перед тем, как спросить, к какому файлу мы хотим перейти. Можно удалить из кэша конкретный файл (<code>M-x projectile-purge-file-from-cache</code>) или каталог <code>M-x projectile-purge-dir-from-cache</code>. Но мне не было нужно. А <code>C-c p z</code>, наоборот, добавляет текущий файл в кэш проекта, что тоже как-то не было нужно. Обычно новый файл в папке проекта добавляется в кэш, как только открываешь этот файл.</p>
<h2 id="игнорировать-файлы-и-подкаталоги">Игнорировать файлы и подкаталоги</h2>
<p>Если мы хотим велеть Projectile игнорировать определённые файлы при индексировании проекта, можно указать в файле .projectile пути к ним относительно корня проекта, начинающиеся со /. То, что надо игнорировать, указываем со знаком - в начале строки. Или просто ничего не ставим. Пример для типичного Rails-приложения:</p>
<pre><code>-/log
-/tmp
-/vendor
-/public/uploads</code></pre>
<p>Это заставит игнорировать папки в корне проекта. Можно и иначе:</p>
<pre><code>-tmp
-*.rb
-*.yml
-models</code></pre>
<p>Можно, наоборот, игнорировать всё, кроме определённых нужных каталогов, если так проще. Если мы выбрали, какие каталоги смотреть, это значит, что всё остальное игнорируется.</p>
<p>Пример:</p>
<pre><code>+/src/foo
+/tests/foo</code></pre>
<p>К сожалению, маски файлов так выбирать нельзя. Только подкаталоги.</p>
<p>Если указаны и подкаталоги, которые игнорировать, и те, которые смотреть, то сначала применяются правила, что смотреть, потом выбранное проверяется на предмет, не надо ли там ещё что-то игнорировать.</p>
<h2 id="кнопочки">Кнопочки</h2>
<p>Удобно смотреть список по <code>C-c p C-h</code>. Можно заменить префикс <code>C-c p</code> на что-то другое примерно так: <code>(setq projectile-keymap-prefix (kbd C-c C-p))</code>. Или добавить альтернативный префикс: <code>(define-key projectile-mode-map (kbd s-p) ’projectile-command-map)</code></p>
<p>Разумеется, можно добавлять свои команды...</p>
<h2 id="настройки-проекта">Настройки проекта</h2>
<p>Настройки могут отличаться от проекта к проекту, даже если это один язык. На этот случай есть <code>.dir-locals.el</code>, чтоб устанавливать настройки конкретно для каталога (и подкаталогов) проекта. В projectile можно открыть так: <code>C-c p E (M-x projectile-edit-dir-locals RET)</code>.</p>
<p>В файле может быть что-то такое:</p>
<pre><code>((nil . ((secret-ftp-password . &quot;secret&quot;)
         (compile-command . &quot;make target-x&quot;)
         (eval . (progn
                   (defun my-project-specific-function ()
                     ;; ...
                     ))))
 (c-mode . (c-file-style . &quot;BSD&quot;)))</code></pre>
<p>Скобочки надо ещё пересчитать, что-то я в них не уверена.</p>
<p>Projectile предлагает много настроек через defcustom. Эти же настройки для отдельного проекта пишутся в dir-locals.el.</p>
<p>Так можно включить кэширование только для отдельного проекта:</p>
<pre><code>((nil . ((projectile-enable-caching . t))))</code></pre>
<p>Так добавить игнорируемый файл:</p>
<pre><code>((nil . ((projectile-globally-ignored-files . '(&quot;MyBinaryFile&quot;)))))</code></pre>
<p>Так поменять название проекта в modeline. И именно этим я пользуюсь!</p>
<pre><code>((nil . ((projectile-project-name . &quot;your-project-name-here&quot;))))</code></pre>
<h2 id="mode-line">Mode line</h2>
<p>В modeline по умолчанию Projectile выглядит как <code> Projectile[ProjectName]</code>. Но! Это настраивается - специальная переменная <code>projectile-mode-line</code>, которой нужно скормить что-то вроде</p>
<pre><code>'(:eval (format &quot; Proj[%s]&quot; (projectile-project-name))).</code></pre>
<p>И это хорошо, потому что поумолчательный вариант уж очень длинный. А как укоротить project-name мы уже знаем.</p>
<p>Название проекта по умолчанию не возникает, если это удалённые файлы, редактируемые через TRAMP. Пишут, слишком медленная операция получается.</p>
<h2 id="perspective">perspective</h2>
<p>Создаёт именованные «перспективы», и из такой «перспективы» по умолчанию доступны лишь её буферы, а не все открытые. В сочетании с projectile (проект - перспектива) понятна, без — вряд ли удобна, ибо вручную что ли каждый раз буферы в перспективу добавлять? Не сохраняет же. Чтоб включить - <code>M-x persp-mode</code>.</p>
<h2 id="проблемы">Проблемы</h2>
<p>TRAMP c <code>/sudo::</code> не дружит с <code>projectile-global-mode</code>. Если возникла проблема, надо выключить <code>projectile</code>, открыть нужное, потом можно снова включить <code>projectile</code>, и до перезапуска emacs проблемы не будет. <a href="https://github.com/bbatsov/projectile/issues/835" class="uri">https://github.com/bbatsov/projectile/issues/835</a></p>
<h2 id="ссылки">Ссылки</h2>
<ul>
<li><p><a href="https://gist.github.com/ptrv/4576213" class="uri">https://gist.github.com/ptrv/4576213</a> - настроечный файл для ctags, чтоб тежить латех. Правда, я не уверена, что оно мне надо.</p></li>
</ul>
